#!/bin/bash
my_dir="$(dirname "$0")"

# this will be removed in the future
$my_dir/common-temp

juju-log "ScaleIO SDS installing"
apt-get -qq update

. "$my_dir/common"

if ! puppet --version ; then
  apt-get install -qqfy puppet
fi
puppet module install --version "<1.2.0" cloudscaling-scaleio || /bin/true

ftp=`config-get scaleio-driver-ftp`
if [ -n "$ftp" ] ; then
  ftp_opt="ftp=>'$ftp'"
fi
server-cmd "class { 'scaleio::sds_server': $ftp_opt }"

status-set waiting "Awaiting relation to scaleio-mdm"

juju-log "ScaleIO SDS installed"
